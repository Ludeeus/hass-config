platform: template
sensors:
  battery_iphone:
    unit_of_measurement: '%'
    value_template: >
        {%- if states.device_tracker.iphone.attributes.battery %}
            {{ states.device_tracker.iphone.attributes.battery }}
        {% else %}
            {{ states.sensor.battery_iphone.state }}
        {%- endif %}
    icon_template: '{%- if  states.device_tracker.iphone.attributes.battery < 5 %}mdi:battery-outline{%- elif states.device_tracker.iphone.attributes.battery > 95 %}mdi:battery{% else %}mdi:battery-{{(states.device_tracker.iphone.attributes.battery|float / 10)|round*10}}{%- endif %}'